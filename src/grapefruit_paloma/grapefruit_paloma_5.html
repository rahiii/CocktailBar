{% extends 'navbar.html' %}

{% block title %}StepÂ 5â€¯â€“â€¯Serve | CocktailÂ Bar{% endblock %}

{% block extra_head %}
<style>
    body {
        background: #fff8ea;
        font-family: system-ui, Roboto, sans-serif
    }

    .step-tag {
        display: inline-block;
        margin: 2rem 1.5rem 1.5rem;
        padding: .5rem 1rem;
        font-weight: bold;
        border: 2px solid #f3ca41;
        background: #fffbe2
    }

    .instructions {
        float: left;
        width: 320px;
        margin-left: 1.5rem;
        padding: 1.5rem;
        border: 2px solid #4d6fb3;
        background: #d4e1fa;
        font-size: 1.05rem
    }

    .instructions h2 {
        margin-bottom: .5rem;
        text-align: center
    }

    .shaker-area {
        position: relative;
        margin-left: 360px;
        min-height: 560px
    }

    .glass {
        display: block;
        width: 180px;
        margin: 80px auto 0
    }

    .ingredient {
        position: absolute;
        width: 80px;
        cursor: grab
    }

    .ingredient img {
        width: 100%;
        display: block
    }

    .congrats-btn {
        display: block;
        margin: 1rem auto;
        padding: .75rem 1.2rem;
        background: #d4f8d4;
        color: #2a7f2a;
        border: 2px solid #2a7f2a;
        border-radius: 4px;
        text-align: center;
        font-weight: bold;
        max-width: 320px
    }

    /* === progress bar === */
    .progress-wrapper {
        width: 100%;
        height: 8px;
        background: #e4e4e4;
    }

    .progress-bar {
        height: 100%;
        background: #4d6fb3;
        width: calc(var(--pct) * 1%);
        transition: width .25s;
    }
</style>
{% endblock %}

{% block content %}

{% set current = 5 %}
<div class="progress-wrapper">
    <div class="progress-bar" style="--pct: {{ current * 20 }};"></div>
</div>


<div class="step-tag">StepÂ 5Â )Â Serve & Enjoy!</div>

<div class="instructions">
    <h2>ADDÂ YOURÂ GARNISH</h2>
    <div class="warning" style="margin-bottom:1rem;color:red;font-weight:700;text-align:center">DON'TÂ DROP THE WRONG
        ITEM!</div>
    <ul>
        <li>Salt pinch</li>
        <li>Citrus wedge</li>
    </ul>
</div>

<div class="shaker-area">
    <img id="glass" class="glass"
        src="https://images.unsplash.com/photo-1551024709-8f23befc6e10?auto=format&fit=crop&w=350&q=60"
        alt="Highball glass" ondrop="drop(event)" ondragover="allowDrop(event)">

    <div id="salt" class="ingredient" style="top:20px;left:30%" draggable="true" ondragstart="drag(event)">
        <img src="https://images.unsplash.com/photo-1511765224389-37f0e77cf0eb?auto=format&fit=crop&w=200&q=60"
            alt="Salt">
    </div>
    <div id="wedge" class="ingredient" style="top:150px;left:70%" draggable="true" ondragstart="drag(event)">
        <img src="https://images.unsplash.com/photo-1510627498534-cf7e9002facc?auto=format&fit=crop&w=200&q=60"
            alt="Citrus wedge">
    </div>
    <div id="wrong" class="ingredient" style="top:280px;left:30%" draggable="true" ondragstart="drag(event)">
        <img src="https://images.unsplash.com/photo-1507748863335-1e1f9b6a8b09?auto=format&fit=crop&w=200&q=60"
            alt="Wrong item">
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    function allowDrop(e) { e.preventDefault(); }
    function drag(e) { e.dataTransfer.setData('text', e.currentTarget.id); }
    function drop(e) {
        e.preventDefault();
        const id = e.dataTransfer.getData('text');
        if (id === 'wrong') { alert("OopsÂ â€“ not a garnish!"); return; }
        document.getElementById(id)?.remove();
        if (!document.getElementById('salt') && !document.getElementById('wedge')) {
            const btn = document.createElement('a');
            btn.className = 'congrats-btn';
            btn.href = "{{ url_for('home') }}";
            btn.textContent = 'ðŸŽ‰Â Paloma ready!Â Returnâ€¯Home';
            document.body.appendChild(btn);
        }
    }
</script>
{% endblock %}